# DGA Malicious Domain Name Detection based on Deep Learning Model LSTM
## 前言

Domain Generation Algorithm (DGA) 是一种由网络犯罪分子设计的技术，用于生成大量的域名，这些域名通常被用作命令与控制服务器（C2服务器）的地址。DGA的主要目的是为了逃避网络安全防护措施，尤其是防止安全机构或执法部门通过静态列表阻止或关闭恶意软件的通信通道。

#### DGA的工作原理

1. **随机生成域名**：DGA使用预定义的算法来生成一系列看似随机的域名。这些域名通常是按照特定的模式或规则生成的，以便于恶意软件能够预测未来某个时间点将要使用的域名。

2. **时间同步**：许多DGA实现依赖于时间戳来确保不同地理位置的恶意软件实例能够在相同的时间生成相同的域名列表。这样，即使不是所有生成的域名都被激活，恶意软件也能在预定的时间连接到正确的C2服务器。

3. **少量激活**：虽然DGA可以生成成千上万个潜在的域名，但实际上只有少数几个会被激活用于实际的C2通信。这种策略增加了追踪和封堵这些域名的难度。

#### 应对措施

由于DGA生成的域名数量庞大且难以预测，传统的黑名单方法对于防御DGA驱动的恶意软件效果有限。因此，网络安全专家采取了多种方法来应对这一挑战：

1. **行为分析**：通过监测网络流量的行为模式，识别可能的DGA活动。例如，频繁尝试连接不存在的域名可能是一个迹象。

2. **逆向工程**：分析捕获的恶意软件样本，试图理解其使用的DGA机制，从而预测未来的域名。

3. **机器学习**：利用机器学习技术来识别和分类DGA生成的域名，这种方法可以通过训练模型来区分正常域名和DGA生成的域名。

4. **法律行动**：与互联网服务提供商合作，提前注册或阻止已知的恶意DGA域名，或者通过法律手段迫使域名注册商或托管服务商采取行动。

总之，DGA是一种复杂的网络攻击技术，需要综合运用多种安全策略和技术手段来进行有效防御。

## 基于LSTM模型的DGA恶意域名检测方法

0. 本方法中设计LSTM深度学习模型建模DGA域名特点，并进行安全检测。

1. 针对由域名生成算法（DGA）生成的 C&C 域名具有生成方式多样、特征难以统一提取的问题，提出一种对域名进行二元文法（Bigram）处理后，通过 Bi-LSTM 模型进行 DGA 域名检测的方法。

2. 首先对所有域名样本进行二元文法（Bigram）处理，并对每一条处理后的域名样本进行长度统计分析，将处理后的域名进行编码并有长度统计结果固定长度，通过 Bi-LSTM 网络模型获得检测结果。

3. 实验使用 Alexa 网站公开的 100 万条域名数据和 28 种 DGA 生成算法生成的共计 140 万余条 DGA 数据样本。

4. 综合比较 Unigram-LSTM、Bigram-LSTM、Unigram-Bi-LSTM、Bigram-Bi-LSTM 的实验结果，最优模型的 dga 误判率1：100。
